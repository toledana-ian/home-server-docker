version: '3.9'
services:
  frigate:
    container_name: frigate
    image: ghcr.io/blakeblackshear/frigate:stable
    restart: unless-stopped
    shm_size: '64mb'
    devices:
      - /dev/dri/renderD128:/dev/dri/renderD128
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - ./docker-volumes/config.yml:/config/config.yml
      - ./docker-volumes/storage:/media/frigate
      - tmpfs-volume:/tmp/cache
    ports:
      - "5000:5000"  # Web interface for Frigate
      - "1935:1935"  # RTMP stream

volumes:
  tmpfs-volume:
    driver_opts:
      type: tmpfs
      device: tmpfs
      o: size=1000000000
